import{b as Z,W as P,d as K,u as Y,c as T,aD as Ke,a_ as Le,a$ as qe,M as ue,N as de,b0 as Ie,al as ae,o as g,a as V,n as $,f as e,x as B,z as G,h as j,A as J,g as C,e as U,w as f,r as ee,E as z,_ as te,j as ke,i as ne,b1 as ie,C as pe,H as M,D as oe,ax as Be,J as Re,ar as we,b2 as We,m as v,a4 as Q,b3 as He,B as Ge,a3 as Xe,b4 as $e,aw as ce,G as Je,b5 as Ne,ao as Oe,X as fe,b6 as N,y as Ye,a5 as Qe,b7 as Ze,a9 as xe,b8 as et,ac as tt,b9 as at,I as ot,s as me,ba as Se,bb as st,bc as nt,K as lt,F as rt,az as it,aO as _e,aj as Ee,L as ut,p as q,bd as Ce,aB as A}from"./index-z1hJ5Cph.js";import{E as dt}from"./el-dialog-N1JfHF6i.js";import"./el-overlay-X1WuJlu_.js";/* empty css                */import{b as ct,E as pt,a as ft}from"./el-form-item-hkvdCSl9.js";import{U as ve,C as ge,I as ye,E as mt}from"./el-input-d0ib9Cgp.js";import{E as vt,a as gt}from"./el-table-column-1bJrMaUz.js";import"./el-scrollbar-T1eaASHH.js";import{i as yt}from"./el-tag-y0BCCjTp.js";import{E as ht}from"./el-button-O8kHkmLi.js";import{o as le,c as re}from"./loading-nuqzq8mj.js";import{E as bt}from"./el-message-box-0PnYAkKn.js";import{i as kt,E as wt}from"./index-6YRnAls-.js";import{u as $t,a as St,c as _t,b as se}from"./use-form-item-vmAXCTid.js";import"./refs-eIyP-T4c.js";import"./scroll-7viUf7_N.js";import"./castArray-03vanRhI.js";import"./_Uint8Array-bsnH_Esz.js";import"./_initCloneObject-ykFolvl_.js";import"./debounce-yb6mxPpC.js";var Et=1,Ct=4;function Pe(s){return ct(s,Et|Ct)}const Pt=Z({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:s=>s>=0&&s<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:P(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:P([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:P(Function),default:s=>`${s}%`}}),Tt=["aria-valuenow"],Vt={viewBox:"0 0 100 100"},Ft=["d","stroke","stroke-linecap","stroke-width"],Dt=["d","stroke","opacity","stroke-linecap","stroke-width"],Ut={key:0},Lt=K({name:"ElProgress"}),It=K({...Lt,props:Pt,setup(s){const l=s,a={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},o=Y("progress"),k=T(()=>({width:`${l.percentage}%`,animationDuration:`${l.duration}s`,backgroundColor:i(l.percentage)})),y=T(()=>(l.strokeWidth/l.width*100).toFixed(1)),m=T(()=>["circle","dashboard"].includes(l.type)?Number.parseInt(`${50-Number.parseFloat(y.value)/2}`,10):0),p=T(()=>{const t=m.value,w=l.type==="dashboard";return`
          M 50 50
          m 0 ${w?"":"-"}${t}
          a ${t} ${t} 0 1 1 0 ${w?"-":""}${t*2}
          a ${t} ${t} 0 1 1 0 ${w?"":"-"}${t*2}
          `}),E=T(()=>2*Math.PI*m.value),D=T(()=>l.type==="dashboard"?.75:1),F=T(()=>`${-1*E.value*(1-D.value)/2}px`),_=T(()=>({strokeDasharray:`${E.value*D.value}px, ${E.value}px`,strokeDashoffset:F.value})),c=T(()=>({strokeDasharray:`${E.value*D.value*(l.percentage/100)}px, ${E.value}px`,strokeDashoffset:F.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),r=T(()=>{let t;return l.color?t=i(l.percentage):t=a[l.status]||a.default,t}),h=T(()=>l.status==="warning"?Ke:l.type==="line"?l.status==="success"?Le:qe:l.status==="success"?ue:de),u=T(()=>l.type==="line"?12+l.strokeWidth*.4:l.width*.111111+2),b=T(()=>l.format(l.percentage));function n(t){const w=100/t.length;return t.map((R,L)=>ae(R)?{color:R,percentage:(L+1)*w}:R).sort((R,L)=>R.percentage-L.percentage)}const i=t=>{var w;const{color:O}=l;if(Ie(O))return O(t);if(ae(O))return O;{const R=n(O);for(const L of R)if(L.percentage>t)return L.color;return(w=R[R.length-1])==null?void 0:w.color}};return(t,w)=>(g(),V("div",{class:$([e(o).b(),e(o).m(t.type),e(o).is(t.status),{[e(o).m("without-text")]:!t.showText,[e(o).m("text-inside")]:t.textInside}]),role:"progressbar","aria-valuenow":t.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[t.type==="line"?(g(),V("div",{key:0,class:$(e(o).b("bar"))},[B("div",{class:$(e(o).be("bar","outer")),style:G({height:`${t.strokeWidth}px`})},[B("div",{class:$([e(o).be("bar","inner"),{[e(o).bem("bar","inner","indeterminate")]:t.indeterminate},{[e(o).bem("bar","inner","striped")]:t.striped},{[e(o).bem("bar","inner","striped-flow")]:t.stripedFlow}]),style:G(e(k))},[(t.showText||t.$slots.default)&&t.textInside?(g(),V("div",{key:0,class:$(e(o).be("bar","innerText"))},[j(t.$slots,"default",{percentage:t.percentage},()=>[B("span",null,J(e(b)),1)])],2)):C("v-if",!0)],6)],6)],2)):(g(),V("div",{key:1,class:$(e(o).b("circle")),style:G({height:`${t.width}px`,width:`${t.width}px`})},[(g(),V("svg",Vt,[B("path",{class:$(e(o).be("circle","track")),d:e(p),stroke:`var(${e(o).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":t.strokeLinecap,"stroke-width":e(y),fill:"none",style:G(e(_))},null,14,Ft),B("path",{class:$(e(o).be("circle","path")),d:e(p),stroke:e(r),fill:"none",opacity:t.percentage?1:0,"stroke-linecap":t.strokeLinecap,"stroke-width":e(y),style:G(e(c))},null,14,Dt)]))],6)),(t.showText||t.$slots.default)&&!t.textInside?(g(),V("div",{key:2,class:$(e(o).e("text")),style:G({fontSize:`${e(u)}px`})},[j(t.$slots,"default",{percentage:t.percentage},()=>[t.status?(g(),U(e(z),{key:1},{default:f(()=>[(g(),U(ee(e(h))))]),_:1})):(g(),V("span",Ut,J(e(b)),1))])],6)):C("v-if",!0)],10,Tt))}});var Bt=te(It,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Rt=ke(Bt),Nt=Z({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:kt},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:ne},activeActionIcon:{type:ne},activeIcon:{type:ne},inactiveIcon:{type:ne},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:P(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1},label:{type:String,default:void 0}}),Ot={[ve]:s=>ie(s)||ae(s)||pe(s),[ge]:s=>ie(s)||ae(s)||pe(s),[ye]:s=>ie(s)||ae(s)||pe(s)},jt=["onClick"],At=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],Mt=["aria-hidden"],zt=["aria-hidden"],Kt=["aria-hidden"],he="ElSwitch",qt=K({name:he}),Wt=K({...qt,props:Nt,emits:Ot,setup(s,{expose:l,emit:a}){const o=s,k=Je(),{formItem:y}=$t(),m=St(),p=Y("switch");(d=>{d.forEach(I=>{He({from:I[0],replacement:I[1],scope:he,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},T(()=>{var W;return!!((W=k.vnode.props)!=null&&W[I[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:D}=_t(o,{formItemContext:y}),F=se(T(()=>o.loading)),_=M(o.modelValue!==!1),c=M(),r=M(),h=T(()=>[p.b(),p.m(m.value),p.is("disabled",F.value),p.is("checked",t.value)]),u=T(()=>[p.e("label"),p.em("label","left"),p.is("active",!t.value)]),b=T(()=>[p.e("label"),p.em("label","right"),p.is("active",t.value)]),n=T(()=>({width:Ge(o.width)}));oe(()=>o.modelValue,()=>{_.value=!0}),oe(()=>o.value,()=>{_.value=!1});const i=T(()=>_.value?o.modelValue:o.value),t=T(()=>i.value===o.activeValue);[o.activeValue,o.inactiveValue].includes(i.value)||(a(ve,o.inactiveValue),a(ge,o.inactiveValue),a(ye,o.inactiveValue)),oe(t,d=>{var I;c.value.checked=d,o.validateEvent&&((I=y==null?void 0:y.validate)==null||I.call(y,"change").catch(W=>Be()))});const w=()=>{const d=t.value?o.inactiveValue:o.activeValue;a(ve,d),a(ge,d),a(ye,d),Xe(()=>{c.value.checked=t.value})},O=()=>{if(F.value)return;const{beforeChange:d}=o;if(!d){w();return}const I=d();[$e(I),ie(I)].includes(!0)||ce(he,"beforeChange must return type `Promise<boolean>` or `boolean`"),$e(I)?I.then(H=>{H&&w()}).catch(H=>{}):I&&w()},R=T(()=>p.cssVarBlock({...o.activeColor?{"on-color":o.activeColor}:null,...o.inactiveColor?{"off-color":o.inactiveColor}:null,...o.borderColor?{"border-color":o.borderColor}:null})),L=()=>{var d,I;(I=(d=c.value)==null?void 0:d.focus)==null||I.call(d)};return Re(()=>{c.value.checked=t.value}),l({focus:L,checked:t}),(d,I)=>(g(),V("div",{class:$(e(h)),style:G(e(R)),onClick:Q(O,["prevent"])},[B("input",{id:e(D),ref_key:"input",ref:c,class:$(e(p).e("input")),type:"checkbox",role:"switch","aria-checked":e(t),"aria-disabled":e(F),"aria-label":d.label,name:d.name,"true-value":d.activeValue,"false-value":d.inactiveValue,disabled:e(F),tabindex:d.tabindex,onChange:w,onKeydown:we(O,["enter"])},null,42,At),!d.inlinePrompt&&(d.inactiveIcon||d.inactiveText)?(g(),V("span",{key:0,class:$(e(u))},[d.inactiveIcon?(g(),U(e(z),{key:0},{default:f(()=>[(g(),U(ee(d.inactiveIcon)))]),_:1})):C("v-if",!0),!d.inactiveIcon&&d.inactiveText?(g(),V("span",{key:1,"aria-hidden":e(t)},J(d.inactiveText),9,Mt)):C("v-if",!0)],2)):C("v-if",!0),B("span",{ref_key:"core",ref:r,class:$(e(p).e("core")),style:G(e(n))},[d.inlinePrompt?(g(),V("div",{key:0,class:$(e(p).e("inner"))},[d.activeIcon||d.inactiveIcon?(g(),U(e(z),{key:0,class:$(e(p).is("icon"))},{default:f(()=>[(g(),U(ee(e(t)?d.activeIcon:d.inactiveIcon)))]),_:1},8,["class"])):d.activeText||d.inactiveText?(g(),V("span",{key:1,class:$(e(p).is("text")),"aria-hidden":!e(t)},J(e(t)?d.activeText:d.inactiveText),11,zt)):C("v-if",!0)],2)):C("v-if",!0),B("div",{class:$(e(p).e("action"))},[d.loading?(g(),U(e(z),{key:0,class:$(e(p).is("loading"))},{default:f(()=>[v(e(We))]),_:1},8,["class"])):d.activeActionIcon&&e(t)?(g(),U(e(z),{key:1},{default:f(()=>[(g(),U(ee(d.activeActionIcon)))]),_:1})):d.inactiveActionIcon&&!e(t)?(g(),U(e(z),{key:2},{default:f(()=>[(g(),U(ee(d.inactiveActionIcon)))]),_:1})):C("v-if",!0)],2)],6),!d.inlinePrompt&&(d.activeIcon||d.activeText)?(g(),V("span",{key:1,class:$(e(b))},[d.activeIcon?(g(),U(e(z),{key:0},{default:f(()=>[(g(),U(ee(d.activeIcon)))]),_:1})):C("v-if",!0),!d.activeIcon&&d.activeText?(g(),V("span",{key:1,"aria-hidden":!e(t)},J(d.activeText),9,Kt)):C("v-if",!0)],2)):C("v-if",!0)],14,jt))}});var Ht=te(Wt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const Gt=ke(Ht),je=Symbol("uploadContextKey"),Xt="ElUpload";class Jt extends Error{constructor(l,a,o,k){super(l),this.name="UploadAjaxError",this.status=a,this.method=o,this.url=k}}function Te(s,l,a){let o;return a.response?o=`${a.response.error||a.response}`:a.responseText?o=`${a.responseText}`:o=`fail to ${l.method} ${s} ${a.status}`,new Jt(o,a.status,l.method,s)}function Yt(s){const l=s.responseText||s.response;if(!l)return l;try{return JSON.parse(l)}catch{return l}}const Qt=s=>{typeof XMLHttpRequest>"u"&&ce(Xt,"XMLHttpRequest is undefined");const l=new XMLHttpRequest,a=s.action;l.upload&&l.upload.addEventListener("progress",y=>{const m=y;m.percent=y.total>0?y.loaded/y.total*100:0,s.onProgress(m)});const o=new FormData;if(s.data)for(const[y,m]of Object.entries(s.data))Ne(m)&&m.length?o.append(y,...m):o.append(y,m);o.append(s.filename,s.file,s.file.name),l.addEventListener("error",()=>{s.onError(Te(a,s,l))}),l.addEventListener("load",()=>{if(l.status<200||l.status>=300)return s.onError(Te(a,s,l));s.onSuccess(Yt(l))}),l.open(s.method,a,!0),s.withCredentials&&"withCredentials"in l&&(l.withCredentials=!0);const k=s.headers||{};if(k instanceof Headers)k.forEach((y,m)=>l.setRequestHeader(m,y));else for(const[y,m]of Object.entries(k))Oe(m)||l.setRequestHeader(y,String(m));return l.send(o),l},Ae=["text","picture","picture-card"];let Zt=1;const be=()=>Date.now()+Zt++,Me=Z({action:{type:String,default:"#"},headers:{type:P(Object)},method:{type:String,default:"post"},data:{type:P([Object,Function,Promise]),default:()=>fe({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:P(Array),default:()=>fe([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:Ae,default:"text"},httpRequest:{type:P(Function),default:Qt},disabled:Boolean,limit:Number}),xt=Z({...Me,beforeUpload:{type:P(Function),default:N},beforeRemove:{type:P(Function)},onRemove:{type:P(Function),default:N},onChange:{type:P(Function),default:N},onPreview:{type:P(Function),default:N},onSuccess:{type:P(Function),default:N},onProgress:{type:P(Function),default:N},onError:{type:P(Function),default:N},onExceed:{type:P(Function),default:N}}),ea=Z({files:{type:P(Array),default:()=>fe([])},disabled:{type:Boolean,default:!1},handlePreview:{type:P(Function),default:N},listType:{type:String,values:Ae,default:"text"}}),ta={remove:s=>!!s},aa=["onKeydown"],oa=["src"],sa=["onClick"],na=["title"],la=["onClick"],ra=["onClick"],ia=K({name:"ElUploadList"}),ua=K({...ia,props:ea,emits:ta,setup(s,{emit:l}){const a=s,{t:o}=Ye(),k=Y("upload"),y=Y("icon"),m=Y("list"),p=se(),E=M(!1),D=T(()=>[k.b("list"),k.bm("list",a.listType),k.is("disabled",a.disabled)]),F=_=>{l("remove",_)};return(_,c)=>(g(),U(at,{tag:"ul",class:$(e(D)),name:e(m).b()},{default:f(()=>[(g(!0),V(Qe,null,tt(_.files,r=>(g(),V("li",{key:r.uid||r.name,class:$([e(k).be("list","item"),e(k).is(r.status),{focusing:E.value}]),tabindex:"0",onKeydown:we(h=>!e(p)&&F(r),["delete"]),onFocus:c[0]||(c[0]=h=>E.value=!0),onBlur:c[1]||(c[1]=h=>E.value=!1),onClick:c[2]||(c[2]=h=>E.value=!1)},[j(_.$slots,"default",{file:r},()=>[_.listType==="picture"||r.status!=="uploading"&&_.listType==="picture-card"?(g(),V("img",{key:0,class:$(e(k).be("list","item-thumbnail")),src:r.url,alt:""},null,10,oa)):C("v-if",!0),r.status==="uploading"||_.listType!=="picture-card"?(g(),V("div",{key:1,class:$(e(k).be("list","item-info"))},[B("a",{class:$(e(k).be("list","item-name")),onClick:Q(h=>_.handlePreview(r),["prevent"])},[v(e(z),{class:$(e(y).m("document"))},{default:f(()=>[v(e(Ze))]),_:1},8,["class"]),B("span",{class:$(e(k).be("list","item-file-name")),title:r.name},J(r.name),11,na)],10,sa),r.status==="uploading"?(g(),U(e(Rt),{key:0,type:_.listType==="picture-card"?"circle":"line","stroke-width":_.listType==="picture-card"?6:2,percentage:Number(r.percentage),style:G(_.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):C("v-if",!0)],2)):C("v-if",!0),B("label",{class:$(e(k).be("list","item-status-label"))},[_.listType==="text"?(g(),U(e(z),{key:0,class:$([e(y).m("upload-success"),e(y).m("circle-check")])},{default:f(()=>[v(e(Le))]),_:1},8,["class"])):["picture-card","picture"].includes(_.listType)?(g(),U(e(z),{key:1,class:$([e(y).m("upload-success"),e(y).m("check")])},{default:f(()=>[v(e(ue))]),_:1},8,["class"])):C("v-if",!0)],2),e(p)?C("v-if",!0):(g(),U(e(z),{key:2,class:$(e(y).m("close")),onClick:h=>F(r)},{default:f(()=>[v(e(de))]),_:2},1032,["class","onClick"])),C(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),C(" This is a bug which needs to be fixed "),C(" TODO: Fix the incorrect navigation interaction "),e(p)?C("v-if",!0):(g(),V("i",{key:3,class:$(e(y).m("close-tip"))},J(e(o)("el.upload.deleteTip")),3)),_.listType==="picture-card"?(g(),V("span",{key:4,class:$(e(k).be("list","item-actions"))},[B("span",{class:$(e(k).be("list","item-preview")),onClick:h=>_.handlePreview(r)},[v(e(z),{class:$(e(y).m("zoom-in"))},{default:f(()=>[v(e(xe))]),_:1},8,["class"])],10,la),e(p)?C("v-if",!0):(g(),V("span",{key:0,class:$(e(k).be("list","item-delete")),onClick:h=>F(r)},[v(e(z),{class:$(e(y).m("delete"))},{default:f(()=>[v(e(et))]),_:1},8,["class"])],10,ra))],2)):C("v-if",!0)])],42,aa))),128)),j(_.$slots,"append")]),_:3},8,["class","name"]))}});var Ve=te(ua,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const da=Z({disabled:{type:Boolean,default:!1}}),ca={file:s=>Ne(s)},pa=["onDrop","onDragover"],ze="ElUploadDrag",fa=K({name:ze}),ma=K({...fa,props:da,emits:ca,setup(s,{emit:l}){const a=ot(je);a||ce(ze,"usage: <el-upload><el-upload-dragger /></el-upload>");const o=Y("upload"),k=M(!1),y=se(),m=E=>{if(y.value)return;k.value=!1,E.stopPropagation();const D=Array.from(E.dataTransfer.files),F=a.accept.value;if(!F){l("file",D);return}const _=D.filter(c=>{const{type:r,name:h}=c,u=h.includes(".")?`.${h.split(".").pop()}`:"",b=r.replace(/\/.*$/,"");return F.split(",").map(n=>n.trim()).filter(n=>n).some(n=>n.startsWith(".")?u===n:/\/\*$/.test(n)?b===n.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(n)?r===n:!1)});l("file",_)},p=()=>{y.value||(k.value=!0)};return(E,D)=>(g(),V("div",{class:$([e(o).b("dragger"),e(o).is("dragover",k.value)]),onDrop:Q(m,["prevent"]),onDragover:Q(p,["prevent"]),onDragleave:D[0]||(D[0]=Q(F=>k.value=!1,["prevent"]))},[j(E.$slots,"default")],42,pa))}});var va=te(ma,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const ga=Z({...Me,beforeUpload:{type:P(Function),default:N},onRemove:{type:P(Function),default:N},onStart:{type:P(Function),default:N},onSuccess:{type:P(Function),default:N},onProgress:{type:P(Function),default:N},onError:{type:P(Function),default:N},onExceed:{type:P(Function),default:N}}),ya=["onKeydown"],ha=["name","multiple","accept"],ba=K({name:"ElUploadContent",inheritAttrs:!1}),ka=K({...ba,props:ga,setup(s,{expose:l}){const a=s,o=Y("upload"),k=se(),y=me({}),m=me(),p=u=>{if(u.length===0)return;const{autoUpload:b,limit:n,fileList:i,multiple:t,onStart:w,onExceed:O}=a;if(n&&i.length+u.length>n){O(u,i);return}t||(u=u.slice(0,1));for(const R of u){const L=R;L.uid=be(),w(L),b&&E(L)}},E=async u=>{if(m.value.value="",!a.beforeUpload)return F(u);let b,n={};try{const t=a.data,w=a.beforeUpload(u);n=Se(a.data)?Pe(a.data):a.data,b=await w,Se(a.data)&&yt(t,n)&&(n=Pe(a.data))}catch{b=!1}if(b===!1){a.onRemove(u);return}let i=u;b instanceof Blob&&(b instanceof File?i=b:i=new File([b],u.name,{type:u.type})),F(Object.assign(i,{uid:u.uid}),n)},D=async(u,b)=>Ie(u)?u(b):u,F=async(u,b)=>{const{headers:n,data:i,method:t,withCredentials:w,name:O,action:R,onProgress:L,onSuccess:d,onError:I,httpRequest:W}=a;try{b=await D(b??i,u)}catch{a.onRemove(u);return}const{uid:H}=u,x={headers:n||{},withCredentials:w,file:u,data:b,method:t,filename:O,action:R,onProgress:X=>{L(X,u)},onSuccess:X=>{d(X,u),delete y.value[H]},onError:X=>{I(X,u),delete y.value[H]}},S=W(x);y.value[H]=S,S instanceof Promise&&S.then(x.onSuccess,x.onError)},_=u=>{const b=u.target.files;b&&p(Array.from(b))},c=()=>{k.value||(m.value.value="",m.value.click())},r=()=>{c()};return l({abort:u=>{st(y.value).filter(u?([n])=>String(u.uid)===n:()=>!0).forEach(([n,i])=>{i instanceof XMLHttpRequest&&i.abort(),delete y.value[n]})},upload:E}),(u,b)=>(g(),V("div",{class:$([e(o).b(),e(o).m(u.listType),e(o).is("drag",u.drag)]),tabindex:"0",onClick:c,onKeydown:we(Q(r,["self"]),["enter","space"])},[u.drag?(g(),U(va,{key:0,disabled:e(k),onFile:p},{default:f(()=>[j(u.$slots,"default")]),_:3},8,["disabled"])):j(u.$slots,"default",{key:1}),B("input",{ref_key:"inputRef",ref:m,class:$(e(o).e("input")),name:u.name,multiple:u.multiple,accept:u.accept,type:"file",onChange:_,onClick:b[0]||(b[0]=Q(()=>{},["stop"]))},null,42,ha)],42,ya))}});var Fe=te(ka,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const De="ElUpload",Ue=s=>{var l;(l=s.url)!=null&&l.startsWith("blob:")&&URL.revokeObjectURL(s.url)},wa=(s,l)=>{const a=nt(s,"fileList",void 0,{passive:!0}),o=c=>a.value.find(r=>r.uid===c.uid);function k(c){var r;(r=l.value)==null||r.abort(c)}function y(c=["ready","uploading","success","fail"]){a.value=a.value.filter(r=>!c.includes(r.status))}const m=(c,r)=>{const h=o(r);h&&(console.error(c),h.status="fail",a.value.splice(a.value.indexOf(h),1),s.onError(c,h,a.value),s.onChange(h,a.value))},p=(c,r)=>{const h=o(r);h&&(s.onProgress(c,h,a.value),h.status="uploading",h.percentage=Math.round(c.percent))},E=(c,r)=>{const h=o(r);h&&(h.status="success",h.response=c,s.onSuccess(c,h,a.value),s.onChange(h,a.value))},D=c=>{Oe(c.uid)&&(c.uid=be());const r={name:c.name,percentage:0,status:"ready",size:c.size,raw:c,uid:c.uid};if(s.listType==="picture-card"||s.listType==="picture")try{r.url=URL.createObjectURL(c)}catch(h){Be(De,h.message),s.onError(h,r,a.value)}a.value=[...a.value,r],s.onChange(r,a.value)},F=async c=>{const r=c instanceof File?o(c):c;r||ce(De,"file to be removed not found");const h=u=>{k(u);const b=a.value;b.splice(b.indexOf(u),1),s.onRemove(u,b),Ue(u)};s.beforeRemove?await s.beforeRemove(r,a.value)!==!1&&h(r):h(r)};function _(){a.value.filter(({status:c})=>c==="ready").forEach(({raw:c})=>{var r;return c&&((r=l.value)==null?void 0:r.upload(c))})}return oe(()=>s.listType,c=>{c!=="picture-card"&&c!=="picture"||(a.value=a.value.map(r=>{const{raw:h,url:u}=r;if(!u&&h)try{r.url=URL.createObjectURL(h)}catch(b){s.onError(b,r,a.value)}return r}))}),oe(a,c=>{for(const r of c)r.uid||(r.uid=be()),r.status||(r.status="success")},{immediate:!0,deep:!0}),{uploadFiles:a,abort:k,clearFiles:y,handleError:m,handleProgress:p,handleStart:D,handleSuccess:E,handleRemove:F,submit:_,revokeFileObjectURL:Ue}},$a=K({name:"ElUpload"}),Sa=K({...$a,props:xt,setup(s,{expose:l}){const a=s,o=se(),k=me(),{abort:y,submit:m,clearFiles:p,uploadFiles:E,handleStart:D,handleError:F,handleRemove:_,handleSuccess:c,handleProgress:r,revokeFileObjectURL:h}=wa(a,k),u=T(()=>a.listType==="picture-card"),b=T(()=>({...a,fileList:E.value,onStart:D,onProgress:r,onSuccess:c,onError:F,onRemove:_}));return lt(()=>{E.value.forEach(h)}),rt(je,{accept:it(a,"accept")}),l({abort:y,submit:m,clearFiles:p,handleStart:D,handleRemove:_}),(n,i)=>(g(),V("div",null,[e(u)&&n.showFileList?(g(),U(Ve,{key:0,disabled:e(o),"list-type":n.listType,files:e(E),"handle-preview":n.onPreview,onRemove:e(_)},_e({append:f(()=>[v(Fe,Ee({ref_key:"uploadRef",ref:k},e(b)),{default:f(()=>[n.$slots.trigger?j(n.$slots,"trigger",{key:0}):C("v-if",!0),!n.$slots.trigger&&n.$slots.default?j(n.$slots,"default",{key:1}):C("v-if",!0)]),_:3},16)]),_:2},[n.$slots.file?{name:"default",fn:f(({file:t})=>[j(n.$slots,"file",{file:t})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):C("v-if",!0),!e(u)||e(u)&&!n.showFileList?(g(),U(Fe,Ee({key:1,ref_key:"uploadRef",ref:k},e(b)),{default:f(()=>[n.$slots.trigger?j(n.$slots,"trigger",{key:0}):C("v-if",!0),!n.$slots.trigger&&n.$slots.default?j(n.$slots,"default",{key:1}):C("v-if",!0)]),_:3},16)):C("v-if",!0),n.$slots.trigger?j(n.$slots,"default",{key:2}):C("v-if",!0),j(n.$slots,"tip"),!e(u)&&n.showFileList?(g(),U(Ve,{key:3,disabled:e(o),"list-type":n.listType,files:e(E),"handle-preview":n.onPreview,onRemove:e(_)},_e({_:2},[n.$slots.file?{name:"default",fn:f(({file:t})=>[j(n.$slots,"file",{file:t})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):C("v-if",!0)]))}});var _a=te(Sa,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Ea=ke(_a),Ca={style:{display:"flex","justify-content":"space-between","align-items":"center",padding:"0 10px"}},Pa=B("h1",null,"產品管理",-1),Ta=B("div",{class:"el-upload__tip"},"僅限上傳 jpg/png",-1),Va={class:"dialog-footer"},Fa=B("div",{class:"el-upload__tip"},"僅限上傳 jpg/png",-1),Da={class:"dialog-footer"},Za=K({__name:"productManage",setup(s){const l=M([]),a=M(!1),o=M(!1),k=M(null),y=M(null),m=M({id:null,name:"",price:null,description:"",image:[],isSale:!1}),p=M({name:"",price:null,description:"",image:[],isSale:!0}),E=M("50%"),D=n=>{m.value=JSON.parse(JSON.stringify(l.value.find(i=>i.id===n))),a.value=!0},F=n=>{n&&n.validate(i=>{if(i){let t=new FormData;t.append("option","add"),t.append("name",p.value.name),t.append("price",p.value.price.toString()),t.append("description",p.value.description),t.append("isSale",p.value.isSale.toString()),p.value.image.forEach(w=>{t.append("image",w.raw)}),le("資料處理中..."),fetch("/api/manage/manageProduct",{method:"POST",headers:{accept:"application/json","cache-control":"no-cache"},body:t}).then(w=>w.json()).then(w=>{w.code===200?(A.success("新增成功!"),o.value=!1,l.value.push(w.data),n.resetFields(),p.value.image=[]):A.error("新增失敗!")}).catch(()=>{A.error("新增失敗!")}).finally(()=>{re()})}})},_=n=>{n&&n.validate(i=>{if(i){let t=new FormData;t.append("option","edit"),t.append("productId",m.value.id.toString()),t.append("name",m.value.name),t.append("price",m.value.price.toString()),t.append("description",m.value.description),t.append("isSale",m.value.isSale.toString()),m.value.image.forEach(w=>{t.append("image",w.raw)}),le("資料處理中..."),fetch("/api/manage/manageProduct",{method:"POST",headers:{accept:"application/json","cache-control":"no-cache"},body:t}).then(w=>w.json()).then(w=>{w.code===200?(A.success("修改成功!"),a.value=!1,r()):A.error("修改失敗!")}).catch(()=>{A.error("修改失敗!")}).finally(()=>{re()})}})},c=n=>{bt.confirm("此操作將刪除該產品!, 是否繼續?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then(()=>{let i=new FormData;i.append("option","delete"),i.append("productId",n.id.toString()),le("資料處理中..."),fetch("/api/manage/manageProduct",{method:"POST",headers:{accept:"application/json","cache-control":"no-cache"},body:i}).then(t=>t.json()).then(t=>{t.code===200?(A.success("刪除成功!"),l.value=l.value.filter(w=>w.id!==n.id)):A.error("刪除失敗!")}).catch(()=>{A.error("刪除失敗!")})}).catch(()=>{}).finally(()=>{re()})},r=()=>{le("資料載入中..."),fetch("/api/manage/getAllProduct",{headers:{"Content-Type":"application/json"}}).then(n=>n.json()).then(n=>{n.code===200?l.value=n.data:A.error("資料取得失敗")}).catch(()=>{A.error("資料取得失敗")}).finally(()=>{re()})},h=n=>{const i=n.type==="image/jpeg"||n.type==="image/png"||n.type==="image/jpg";return i||A.error("上傳檔案格式錯誤!"),i},u=()=>{A.warning("只能上傳一個檔案")};Re(()=>{r(),E.value=window.innerWidth<768?"90%":"50%",window.addEventListener("resize",()=>{E.value=window.innerWidth<768?"90%":"50%"})});const b=ut({name:[{required:!0,message:"請輸入產品名稱",trigger:"change"}],price:[{required:!0,message:"請輸入價格",trigger:"change"},{type:"number",message:"請輸入數字",trigger:"change"}]});return(n,i)=>{const t=ht,w=vt,O=wt,R=gt,L=mt,d=pt,I=Gt,W=Ea,H=ft,x=dt;return g(),V("div",null,[B("div",Ca,[Pa,v(t,{type:"primary",onClick:i[0]||(i[0]=S=>o.value=!0)},{default:f(()=>[q("新增產品")]),_:1})]),v(R,{data:e(l),style:{width:"100%"}},{default:f(()=>[v(w,{label:"產品名稱",prop:"name"}),v(w,{label:"價格",prop:"price"}),v(w,{label:"產品狀態",prop:"description"},{default:f(S=>[v(O,{effect:"dark",type:S.row.isSale===!0?"success":"danger"},{default:f(()=>[q(J(S.row.isSale===!0?"販售中":"已下架"),1)]),_:2},1032,["type"])]),_:1}),v(w,{fixed:"right",label:"操作"},{default:f(S=>[v(t,{size:"small",onClick:X=>D(S.row.id)},{default:f(()=>[q("修改")]),_:2},1032,["onClick"]),v(t,{size:"small",type:"danger",onClick:X=>c(S.row)},{default:f(()=>[q("刪除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),v(x,{modelValue:e(a),"onUpdate:modelValue":i[8]||(i[8]=S=>Ce(a)?a.value=S:null),title:"修改產品資訊",width:e(E)},{footer:f(()=>[B("span",Va,[v(t,{onClick:i[6]||(i[6]=S=>a.value=!1)},{default:f(()=>[q("取消")]),_:1}),v(t,{type:"primary",onClick:i[7]||(i[7]=S=>_(e(k)))},{default:f(()=>[q(" 修改 ")]),_:1})])]),default:f(()=>[v(H,{model:e(m),ref_key:"editDataFormRef",ref:k,rules:e(b)},{default:f(()=>[v(d,{label:"產品名稱",prop:"name"},{default:f(()=>[v(L,{modelValue:e(m).name,"onUpdate:modelValue":i[1]||(i[1]=S=>e(m).name=S),autocomplete:"off"},null,8,["modelValue"])]),_:1}),v(d,{label:"價格",prop:"price"},{default:f(()=>[v(L,{modelValue:e(m).price,"onUpdate:modelValue":i[2]||(i[2]=S=>e(m).price=S),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])]),_:1}),v(d,{label:"產品敘述"},{default:f(()=>[v(L,{modelValue:e(m).description,"onUpdate:modelValue":i[3]||(i[3]=S=>e(m).description=S),autocomplete:"off",type:"textarea"},null,8,["modelValue"])]),_:1}),v(d,{label:"產品販售狀態",prop:"isSale"},{default:f(()=>[v(I,{modelValue:e(m).isSale,"onUpdate:modelValue":i[4]||(i[4]=S=>e(m).isSale=S),"inline-prompt":"","active-icon":e(ue),"inactive-icon":e(de)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),v(W,{"file-list":e(m).image,"onUpdate:fileList":i[5]||(i[5]=S=>e(m).image=S),"list-type":"picture","auto-upload":!1,"before-upload":h,limit:1,"on-exceed":u},{tip:f(()=>[Ta]),default:f(()=>[v(t,{type:"primary"},{default:f(()=>[q("選擇照片")]),_:1})]),_:1},8,["file-list"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","width"]),v(x,{modelValue:e(o),"onUpdate:modelValue":i[16]||(i[16]=S=>Ce(o)?o.value=S:null),title:"新增產品",width:e(E)},{footer:f(()=>[B("span",Da,[v(t,{onClick:i[14]||(i[14]=S=>a.value=!1)},{default:f(()=>[q("取消")]),_:1}),v(t,{type:"primary",onClick:i[15]||(i[15]=S=>F(e(y)))},{default:f(()=>[q(" 新增 ")]),_:1})])]),default:f(()=>[v(H,{model:e(p),ref_key:"newProductFormRef",ref:y,rules:e(b)},{default:f(()=>[v(d,{label:"產品名稱",prop:"name"},{default:f(()=>[v(L,{modelValue:e(p).name,"onUpdate:modelValue":i[9]||(i[9]=S=>e(p).name=S),autocomplete:"off"},null,8,["modelValue"])]),_:1}),v(d,{label:"價格",prop:"price"},{default:f(()=>[v(L,{modelValue:e(p).price,"onUpdate:modelValue":i[10]||(i[10]=S=>e(p).price=S),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])]),_:1}),v(d,{label:"產品敘述"},{default:f(()=>[v(L,{modelValue:e(p).description,"onUpdate:modelValue":i[11]||(i[11]=S=>e(p).description=S),autocomplete:"off",type:"textarea"},null,8,["modelValue"])]),_:1}),v(d,{label:"產品販售狀態",prop:"isSale"},{default:f(()=>[v(I,{modelValue:e(p).isSale,"onUpdate:modelValue":i[12]||(i[12]=S=>e(p).isSale=S),"inline-prompt":"","active-icon":e(ue),"inactive-icon":e(de)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),v(W,{"file-list":e(p).image,"onUpdate:fileList":i[13]||(i[13]=S=>e(p).image=S),"list-type":"picture","auto-upload":!1,"before-upload":h,limit:1,"on-exceed":u},{tip:f(()=>[Fa]),default:f(()=>[v(t,{type:"primary"},{default:f(()=>[q("選擇照片")]),_:1})]),_:1},8,["file-list"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","width"])])}}});export{Za as default};
